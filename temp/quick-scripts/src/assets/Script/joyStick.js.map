{"version":3,"sources":["assets/Script/joyStick.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport waterDrop from './waterDrop';\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class joyStick extends cc.Component {\n    @property({ type: cc.Node })\n    joyStick: cc.Node = null;\n    @property({ type: cc.Vec2 })\n    direction = cc.Vec2.ZERO;\n    // direction: cc.Vec2 = cc.Vec2.ZERO;\n\n    onTouchStart(event: cc.Event.EventTouch): void {\n        this.onTouchMove(event);\n    }\n\n    onTouchMove(event: cc.Event.EventTouch): void {\n        const touchPos = this.joyStick.convertToNodeSpaceAR(event.getLocation());\n        const radius = this.joyStick.width / 2;\n\n        //计算触摸点与锚点的距离\n        const dist: number = touchPos.mag();\n\n        //若触摸点超出范围，则将触摸点限制在范围内\n        if (dist > radius) {\n            touchPos.normalizeSelf().mulSelf(radius);\n        }\n\n        // 根据触摸点位置计算输入方向\n        this.direction.x = touchPos.x / radius;\n        this.direction.y = touchPos.y / radius;\n    }\n\n    private onTouchEnd(event: cc.Event.EventTouch) {\n        // 重置输入方向\n        this.direction = cc.Vec2.ZERO;\n    }\n    protected onLoad(): void {\n        this.joyStick.on(cc.Node.EventType.TOUCH_START, this.onTouchStart.bind(this), this);\n        this.joyStick.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove.bind(this), this);\n        this.joyStick.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd.bind(this), this);\n        this.joyStick.on(cc.Node.EventType.TOUCH_CANCEL, this.onTouchEnd.bind(this), this);\n    }\n    onDestroy() {\n        this.joyStick.off(cc.Node.EventType.TOUCH_START, this.onTouchStart.bind(this), this);\n        this.joyStick.off(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove.bind(this), this);\n        this.joyStick.off(cc.Node.EventType.TOUCH_END, this.onTouchEnd.bind(this), this);\n        this.joyStick.off(cc.Node.EventType.TOUCH_CANCEL, this.onTouchEnd.bind(this), this);\n    }\n}\n"]}